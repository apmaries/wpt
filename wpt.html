<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="cache-control" content="no-cache" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <title>WEM Power Tools - Home</title>
    <link rel="icon" href="/wpt/favicon.ico" type="image/x-icon" />

    <!-- Genesys stuff https://spark.genesys.com/ -->
    <link
      href="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.1-178/genesys-webcomponents/genesys-webcomponents.css"
      rel="stylesheet"
    />
    <script
      type="module"
      src="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.1-178/genesys-webcomponents/genesys-webcomponents.esm.js"
    ></script>

    <!-- External stuff -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- Project stuff -->
    <script>
      // Check if testing mode is active
      var testingMode = true; // Set this variable based on your testing mode condition

      // Load the script only if testing mode is active
      if (testingMode) {
        sessionStorage.setItem("test_mode", true);
        const favicon = document.querySelector("link[rel='icon']");
        favicon.href = "/.test/test_favicon.ico";
      }
    </script>
    <link href="./css/new_style.css" type="text/css" rel="stylesheet" />
    <script src="./js/components/nav.js"></script>
    <script src="./js/components/breadcumbs.js"></script>
  </head>
  <body>
    <header id="header" class="primary-section">
      <nav>
        <div id="header065" class="sub-section-065">
          <ul id="nav-items">
            <h1 id="title">
              WEM Power Tools
              <svg id="banner" width="4000" height="50" viewBox="0 0 5000 250">
                <g transform="translate(100 0) rotate(180, -2475, 0)">
                  <path
                    id="API-expanded"
                    d="M151.93,167.356v18.928a69.538,69.538,0,0,1-63.091,69.145v41.244a6.345,6.345,0,1,1-12.691,0v-47.3a6.345,6.345,0,0,1,6.345-6.345,56.809,56.809,0,0,0,56.746-56.74V173.7H25.748v12.583a56.987,56.987,0,0,0,23.23,45.794,6.345,6.345,0,1,1-7.494,10.241A69.722,69.722,0,0,1,13.057,186.29V167.356a6.345,6.345,0,0,1,6.345-6.345H57.22V116.365a6.345,6.345,0,0,1,12.691,0v44.645H95.076V116.365a6.345,6.345,0,1,1,12.691,0v44.645h37.818A6.345,6.345,0,0,1,151.93,167.356ZM88.839,47.766V6.477a6.345,6.345,0,0,0-12.691,0V47.766a69.513,69.513,0,0,0-63.091,69.113v18.934a6.345,6.345,0,0,0,6.345,6.345H38.33a6.345,6.345,0,1,0,0-12.691H25.748V116.879a56.746,56.746,0,1,1,113.492,0v12.589H126.657a6.345,6.345,0,1,0,0,12.691h18.928a6.345,6.345,0,0,0,6.345-6.345V116.879A69.513,69.513,0,0,0,88.839,47.766Z"
                    transform="translate(0 0) rotate(-90)"
                    fill="#ff4f1f"
                  />
                  <!-- Extending straight lines -->
                  <line
                    x1="300"
                    y1="-82.5"
                    x2="5000"
                    y2="-82.5"
                    stroke="#ff4f1f"
                    stroke-width="13"
                  />
                  <line
                    x1="-7000"
                    y1="-82.5"
                    x2="10"
                    y2="-82.5"
                    stroke="#ff4f1f"
                    stroke-width="13"
                  />
                </g>
              </svg>
            </h1>
            <!-- Nav items are dynamically added by nav.js -->
          </ul>
        </div>
        <div id="header035" class="sub-section-035"></div>
      </nav>
      <div id="breadcumbs-container">
        <gux-breadcrumbs id="breadcrumbs" accent="primary">
          <!-- Breadcrumbs added dynamically by breadcrumbs.js -->
        </gux-breadcrumbs>
      </div>

      <div id="subheader">
        <p id="authenticatedSubHeader"></p>
        <p>
          <gux-button id="disconnectButton" accent="primary">
            Disconnect
          </gux-button>
        </p>
      </div>
    </header>

    <main>
      <section class="primary-section">
        <h1>Welcome to the WEM Power Tools!</h1>
        <p>Select from below list or select from above navigation</p>

        <div id="tools-div-all">
          <section>
            <gux-card-beta class="primary-card">
              <h2>Gamification</h2>

              <div>
                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Profiles</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a href="./pages/gf/replicate_profile.html"
                            >Replicate profile (coming soon!)</a
                          >
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>
              </div>
            </gux-card-beta>
          </section>

          <section>
            <gux-card-beta class="primary-card">
              <h2>People & Directory</h2>

              <div>
                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Groups</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Import groups (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Queues & Skills</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Bulk update by group (coming soon!)</a>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Bulk update by WFM MU (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Roles & Permissions</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Copy customer role (coming soon!)</a>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Export permissions (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Users</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Bulk update users (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Work Teams</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a href="./pages/pd/import_workteams.html"
                            >Import work teams</a
                          >
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>
              </div>
            </gux-card-beta>
          </section>

          <section>
            <gux-card-beta class="primary-card">
              <h2>Quality Management</h2>

              <div>
                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Policies</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a h>Replicate policy (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>
              </div>
            </gux-card-beta>
          </section>

          <section>
            <gux-card-beta class="primary-card">
              <h2>Speech & Text Analytics</h2>
              <div class="toy-table-container">
                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Sentiment Feedback</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a href="./pages/st/import_sentiment.html"
                            >Import sentiment phrases
                          </a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>
              </div>
            </gux-card-beta>
          </section>

          <section>
            <gux-card-beta class="primary-card">
              <h2>Workforce Management</h2>

              <div class="toy-table-container">
                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Configuration</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Copy activity codes (coming soon!)</a>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Copy work plans (coming soon!)</a>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Export activity codes (coming soon!)</a>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Export BU list (coming soon!)</a>
                        </td>
                      </tr>

                      <tr>
                        <td>
                          <a>Export all config for As Built (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Forecasts & Historical Data</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a href="./pages/wm/export_historical_data.html"
                            >Export historical data</a
                          >
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Historical data import tool (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Schedules</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a>Schedule import (In development)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>

                <gux-card-beta accent="raised" class="secondary-card">
                  <table>
                    <thead>
                      <tr>
                        <td>Time Off</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <a href="./pages/wm/import_timeoff.html"
                            >Import time off</a
                          >
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a>Import time off limits (coming soon!)</a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </gux-card-beta>
              </div>
            </gux-card-beta>
          </section>
        </div>
      </section>
    </main>

    <footer>
      <p>
        Questions? Requests? Problems? Let me know by
        <a
          href="mailto:andy.maries@genesys.com?subject=WPT%20Feedback"
          style="color: #ff4c1c"
          >email</a
        >
      </p>
    </footer>

    <script>
      // Get access token from url hash and store it in session storage if hash is present
      const hash = window.location.hash;
      if (hash) {
        // Remove the '#' symbol
        var tokenString = hash.substring(1);

        // Create a URLSearchParams object
        var urlParams = new URLSearchParams(tokenString);

        // Extract the access token
        var accessToken = urlParams.get("access_token");

        // Extract other parameters
        var expiresIn = urlParams.get("expires_in");
        var tokenType = urlParams.get("token_type");

        // Check if any of the values are falsy
        if (!accessToken || !expiresIn || !tokenType) {
          console.error("WPT: Invalid token parameters");
          alert("Invalid token parameters. Redirecting to login page.");
          sessionStorage.clear();
          window.location.href = "https://apmaries.github.io/wpt/index.html";
        } else {
          // Store the parameters in sessionStorage
          sessionStorage.setItem("token", accessToken);
          sessionStorage.setItem("token_expires_in", expiresIn);
          sessionStorage.setItem("token_type", tokenType);
        }
      }
    </script>

    <!-- Load the PureCloud platform client library -->
    <script src="https://sdk-cdn.mypurecloud.com/javascript/latest/purecloud-platform-client-v2.min.js"></script>

    <!-- Load the session.js module -->
    <script type="module" src="./js/utils/session.js" defer></script>

    <!-- Load the disconnect.js module -->
    <script type="module" src="./js/utils/disconnect.js" defer></script>
  </body>
</html>
